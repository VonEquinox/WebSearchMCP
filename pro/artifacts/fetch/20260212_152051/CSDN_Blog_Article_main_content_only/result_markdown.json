{
  "success": true,
  "url": "https://blog.csdn.net/wtyuong/article/details/136691433",
  "via_worker": false,
  "via_playwright": true,
  "markdown": "ã€2024ã€‘æ‰¹é‡æŸ¥è¯¢CSDNæ–‡ç« è´¨é‡åˆ† å†™åœ¨æœ€å‰é¢ä¸€ã€å…¨éƒ¨ä»£ç äºŒã€éœ€è¦ä¿®æ”¹çš„åœ°æ–¹1. åšå®¢é¦–é¡µ2. è´¨é‡åˆ†æŸ¥è¯¢ ğŸŒˆä½ å¥½å‘€ï¼æˆ‘æ˜¯ æ˜¯Yuæ¬¸ ğŸŒŒ 2024æ¯æ—¥ç™¾å­—ç¯†åˆ»æ—¶å…‰ï¼Œæ„Ÿè°¢ä½ çš„é™ªä¼´ä¸æ”¯æŒ ~ ğŸš€ æ¬¢è¿ä¸€èµ·è¸ä¸Šæ¢é™©ä¹‹æ—…ï¼ŒæŒ–æ˜æ— é™å¯èƒ½ï¼Œå…±åŒæˆé•¿ï¼ å‰äº›å¤©å‘ç°äº†ä¸€ä¸ªäººå·¥æ™ºèƒ½å­¦ä¹ ç½‘ç«™ï¼Œå†…å®¹æ·±å…¥æµ…å‡ºã€æ˜“äºç†è§£ã€‚å¦‚æœå¯¹äººå·¥æ™ºèƒ½æ„Ÿå…´è¶£ï¼Œä¸å¦¨ç‚¹å‡»æŸ¥çœ‹ã€‚ å†™åœ¨æœ€å‰é¢ ä¹‹å‰çš„ä»£ç ä¸€ç›´æŠ¥é”™521ï¼Œä¸æ¸…æ¥šä»€ä¹ˆåŸå›  å› æ­¤é‡æ–°åˆ†ææ•´ä¸ªè¿‡ç¨‹ï¼Œå¹¶å¯¹ä»£ç è¿›è¡Œæ›´æ–° ç»“æœå¦‚å›¾ å‚è€ƒï¼š æ‰¹é‡è·å–CSDNæ–‡ç« å¯¹æ–‡ç« è´¨é‡åˆ†è¿›è¡Œæ£€æµ‹ï¼Œæœ‰åŠ©äºä¼˜åŒ–æ–‡ç« è´¨é‡ ã€pythonã€‘æˆ‘ç”¨pythonå†™äº†ä¸€ä¸ªå¯ä»¥æ‰¹é‡æŸ¥è¯¢æ–‡ç« è´¨é‡åˆ†çš„å°é¡¹ç›®ï¼ˆçº¯pythonã€flask+htmlã€æ‰“åŒ…æˆexeæ–‡ä»¶ï¼‰ ä¸€ã€å…¨éƒ¨ä»£ç  import json import pandas as pd from openpyxl import Workbook, load_workbook from openpyxl.utils.dataframe import dataframe_to_rows import math import requests # æ‰¹é‡è·å–æ–‡ç« ä¿¡æ¯å¹¶ä¿å­˜åˆ°excel class CSDNArticleExporter: def __init__(self, username, cookies, Referer, page, size, filename): self.username = username self.cookies = cookies self.Referer = Referer self.size = size self.filename = filename self.page = page def get_articles(self): url = \"https://blog.csdn.net/community/home-api/v1/get-business-list\" params = { \"page\": {self.page}, \"size\": {self.size}, \"businessType\": \"blog\", \"username\": {self.username} } headers = { 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3', 'Cookie': self.cookies, # Setting the cookies string directly in headers 'Referer': self.Referer } try: response = requests.get(url, params=params, headers=headers) response.raise_for_status() # Raises an HTTPError if the response status code is 4XX or 5XX data = response.json() return data.get('data', {}).get('list', []) except requests.exceptions.HTTPError as e: print(f\"HTTPé”™è¯¯: {e.response.status_code} {e.response.reason}\") except requests.exceptions.RequestException as e: print(f\"è¯·æ±‚å¼‚å¸¸: {e}\") except json.JSONDecodeError: print(\"è§£æJSONå¤±è´¥\") return [] def export_to_excel(self): df = pd.DataFrame(self.get_articles()) df = df[['title', 'url', 'postTime', 'viewCount', 'collectCount', 'diggCount', 'commentCount']] df.columns = ['æ–‡ç« æ ‡é¢˜', 'URL', 'å‘å¸ƒæ—¶é—´', 'é˜…è¯»é‡', 'æ”¶è—é‡', 'ç‚¹èµé‡', 'è¯„è®ºé‡'] # df.to_excel(self.filename) # ä¸‹é¢çš„ä»£ç ä¼šè®©excelæ¯åˆ—éƒ½æ˜¯åˆé€‚çš„åˆ—å®½ï¼Œå¦‚è¾¾åˆ°æœ€ä½³é˜…è¯»æ•ˆæœ # ä½ åªç”¨ä¸Šé¢çš„ä¿å­˜ä¹Ÿæ˜¯å¯ä»¥çš„ # Create a new workbook and select the active sheet wb = Workbook() sheet = wb.active # Write DataFrame to sheet for r in dataframe_to_rows(df, index=False, header=True): sheet.append(r) # Iterate over the columns and set column width to the max length in each column for column in sheet.columns: max_length = 0 column = [cell for cell in column] for cell in column: try: if len(str(cell.value)) > max_length: max_length = len(cell.value) except: pass adjusted_width = (max_length + 5) sheet.column_dimensions[column[0].column_letter].width = adjusted_width # Save the workbook wb.save(self.filename) class ArticleScores: def __init__(self, filepath): self.filepath = filepath @staticmethod def get_article_score(article_url): url = \"https://bizapi.csdn.net/trends/api/v1/get-article-score\" # TODO: Replace with your actual headers headers = { \"Accept\": \"application/json, text/plain, */*\", \"X-Ca-Key\": \"203930474\", \"X-Ca-Nonce\": \"b35e1821-05c2-458d-adae-3b720bb15fdf\", \"X-Ca-Signature\": \"gjeSiKTRCh8aDv0UwThIVRITc/JtGJkgkZoLVeA6sWo=\", \"X-Ca-Signature-Headers\": \"x-ca-key,x-ca-nonce\", \"X-Ca-Signed-Content-Type\": \"multipart/form-data\", } data = {\"url\": article_url} try: response = requests.post(url, headers=headers, data=data) response.raise_for_status() # This will raise an error for bad responses return response.json().get('data', {}).get('score', 'Score not found') except requests.RequestException as e: print(f\"Request failed: {e}\") return \"Error fetching score\" def get_scores_from_excel(self): df = pd.read_excel(self.filepath) urls = df['URL'].tolist() scores = [self.get_article_score(url) for url in urls] return scores def write_scores_to_excel(self): df = pd.read_excel(self.filepath) df['è´¨é‡åˆ†'] = self.get_scores_from_excel() df.to_excel(self.filepath, index=False) if __name__ == '__main__': total = 10 #å·²å‘æ–‡ç« æ€»æ•°é‡ # TODO:è°ƒæ•´ä¸ºä½ è‡ªå·±çš„cookiesï¼ŒRefererï¼ŒCSDNid, headers cookies = 'uuid_tt_dd=10' # Simplified for brevity Referer = 'https://blog.csdn.net/WTYuong?type=blog' CSDNid = 'WTYuong' t_index = math.ceil(total/100)+1 #å‘ä¸Šå–æ•´ï¼ŒåŠé—­åŠå¼€åŒºé—´ï¼Œå¼€åŒºé—´+1ã€‚ # è·å–æ–‡ç« ä¿¡æ¯ # CSDNArticleExporter(\"å¾…æŸ¥è¯¢ç”¨æˆ·å\", 2ï¼ˆåˆ†é¡µæ•°é‡ï¼ŒæŒ‰æ€»æ–‡ç« æ•°é‡/100æ‰€å¾—çš„åˆ†é¡µæ•°ï¼‰,æ€»æ–‡ç« æ•°é‡ä»…ä¸ºè®¾ç½®ä¸ºå…¨éƒ¨å¯è§çš„æ–‡ç« æ€»æ•°ã€‚ # 100ï¼ˆæœ€å¤§å•æ¬¡æŸ¥è¯¢æ–‡ç« æ•°é‡ä¸å¤§äº100ï¼‰, 'score1.xlsx'ï¼ˆå¾…ä¿å­˜æ•°æ®çš„æ–‡ä»¶ï¼Œéœ€è¦å’Œä¸‹é¢çš„ä¸€è‡´ï¼‰) for index in range(1,t_index): #æ–‡ç« æ€»æ•° filename = \"score\"+str(index)+\".xlsx\" exporter = CSDNArticleExporter(CSDNid, cookies, Referer, index, 100, filename) # Replace with your username exporter.export_to_excel() # æ‰¹é‡è·å–è´¨é‡åˆ† score = ArticleScores(filename) score.write_scores_to_excel() äºŒã€éœ€è¦ä¿®æ”¹çš„åœ°æ–¹ 1. åšå®¢é¦–é¡µ æµè§ˆå™¨è®¿é—®éœ€è¦è·å–æ–‡ç« çš„åšä¸»é¦–é¡µåœ°å€ï¼Œå¹¶ä¸”æ‰“å¼€å¼€å‘è€…å·¥å…·å¿«æ·é”®F12 ç„¶åç‚¹å‡»ç½‘ç»œé€‰é¡¹ï¼Œæˆ‘ä»¬åœ¨åˆ·æ–°é¡µé¢å¯ä»¥çœ‹åˆ°å‘é€çš„è¯·æ±‚åœ°å€ã€‚ ç»è¿‡æµ‹è¯•ï¼Œè¯·æ±‚å¤´åªéœ€è¦åŒ…æ‹¬Cookiesã€Refererå‚æ•°å³å¯ã€‚ å…³äºå¦‚ä½•è·å–cookieï¼š 2. è´¨é‡åˆ†æŸ¥è¯¢ å…ˆå»è´¨é‡æŸ¥è¯¢åœ°å€ï¼šhttps://www.csdn.net/qc ç„¶åè¾“å…¥ä»»æ„ä¸€ç¯‡æ–‡ç« åœ°å€è¿›è¡ŒæŸ¥è¯¢ï¼ŒåŒæ—¶æ£€æŸ¥é¡µé¢ï¼Œåœ¨Networké€‰é¡¹ä¸‹å³å¯çœ‹åˆ°è°ƒç”¨çš„APIçš„è¯·æ±‚åœ°å€ã€è¯·æ±‚æ–¹æ³•ã€è¯·æ±‚å¤´ã€è¯·æ±‚ä½“ç­‰å†…å®¹ï¼š ç»è¿‡æµ‹è¯•ï¼Œè¯·æ±‚å¤´åªéœ€è¦ä¸‹é¢è¿™å‡ ä¸ªå‚æ•°å³å¯ã€‚ è¯·æ±‚å¤´åˆ†æ X-Ca-Key:ä½¿ç”¨è‡ªå·±æµè§ˆå™¨çš„ X-Ca-Nonce:ä½¿ç”¨è‡ªå·±æµè§ˆå™¨çš„ X-Ca-Signature:ä½¿ç”¨è‡ªå·±æµè§ˆå™¨çš„ X-Ca-Signature-Headers:x-ca-key,x-ca-nonce X-Ca-Signed-Content-Type:multipart/form-data Accept :application/json, text/plain, /",
  "truncated": false,
  "blocked": true,
  "extractor": "trafilatura:baseline",
  "quality_score": 80,
  "quality_metrics": {
    "char_len": 4879,
    "line_count": 1,
    "unique_line_ratio": 1.0,
    "noise_line_ratio": 0.0
  },
  "degraded": false
}